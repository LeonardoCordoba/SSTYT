 
--TEMPLATE CON MOLINTES TREN
select count(1) as cantidad
from dbo.molinetes_trenes as tren
inner join dbo.mov_mayo_03 mov
	on tren.id_ramal = mov.ramal and tren.nro_orden = mov.seccion_inicio
where codigotipotrx = 19 and mov.modo = 'TREN' and codigosubtipotrx = 32
	and mov.id_linea = 350
 
--TEMPLATE JOIN DEVICE
select count(1) as cantidad
from dbo.devices_tren as t
inner join dbo.mov_mayo_03 mov
	on t.id_linea = mov.id_linea and t.dev_id = mov.dispositivo
where codigotipotrx = 12 and codigosubtipotrx = 124  and mov.modo = 'TREN' 
	and  mov.id_linea = 350
 
--TEMPLATE JOIN TRENES
select entidad, codigotipotrx, count(1) as cantidad
from trenes t
inner join dbo.mov_mayo_03 mov
on t.codigoterminal = mov.dispositivo
and t.identidad = mov.codigoentidad
where modo = 'tren' and codigotipotrx = 12 and codigosubtipotrx = 124 and mov.id_linea = 350
group by entidad, codigotipotrx
order by cantidad desc
